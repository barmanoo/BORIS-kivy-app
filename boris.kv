#    BORIS mobile
#    Behavioral Observation Research Interactive Software
#    Copyright 2017 Olivier Friard
#
#    This file is part of BORIS mobile.
#
#      BORIS is free software; you can redistribute it and/or modify
#      it under the terms of the GNU General Public License as published by
#      the Free Software Foundation; either version 3 of the License, or
#      any later version.
#
#      BORIS mobile is distributed in the hope that it will be useful,
#      but WITHOUT ANY WARRANTY; without even the implied warranty of
#      MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#      GNU General Public License for more details.
#
#      You should have received a copy of the GNU General Public License
#      along with this program; if not see <http://www.gnu.org/licenses/>.
#
#      www.boris.unito.it


#: import main main
#: import ListAdapter kivy.adapters.listadapter.ListAdapter


BorisRoot:

<BorisRoot>:
    StartPageForm

<StartPageForm>:
    orientation: "vertical"
    Image:
        source: "logo_boris_500px.png"
    Label:
        id: lbversion
        height: "40dp"
        size_hint_y: None
        text: "version 0.0.0 (2017-03-14)"
    BoxLayout:
        height: "40dp"
        size_hint_y: None

        Button:
            text: "Open project"
            size_hint_x: 0.4
            on_press: root.show_SelectProjectForm()

        Button:
            text: "Download project"
            size_hint_x: 0.4
            on_press: root.show_DownloadProject()


#        Button:
#            text: "Receive project"
#            size_hint_x: 0.4
#            on_press: root.receive_project_from_boris()
        Button:
            text: "Exit"
            size_hint_x: 0.2
            on_press: root.exit()

<DownloadProjectForm>
    orientation: "vertical"
    url_input: url
    label1_input: label1
    cb_input: cb

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        Label:
            id: label1
            text: 'Insert the URL of the project'
            #size_hint: None, None

    AnchorLayout:
        anchor_x: 'left'
        anchor_y: 'top'
        #height: "40dp"
        #size_hint_y: None

        BoxLayout:
            size_hint_y: 0.2
            Label:
                size_hint_x: 0.1
                text: "URL"
            TextInput:
                size_hint_x: 0.9
                id: url

    BoxLayout:
        CheckBox:
            active: True
            id: cb
            size_hint_x: 0.1
        Label:
            size_hint_x: 0.9
            text: "Download from BORIS"

    BoxLayout:
        height: "40dp"
        size_hint_y: None

        Button:
            text: "Cancel"
            size_hint_x: 0.2
            on_press: root.cancel()

        Button:
            text: "Download project"
            size_hint_x: 0.8
            on_press: root.download_project()


<ReceiveProject>
    orientation: "vertical"
    lb_receive_input: lb_receive
    Label:
        font_size: 25
        id: lb_receive
        text: "RECEIVING"
    BoxLayout:
        height: "40dp"
        size_hint_y: None
        Button:
            text: "Go back"
            size_hint_x: 0.2
            on_press: root.cancel()
        Button:
            text: "Start listening"
            size_hint_x: 0.8
            on_press: root.start_receiving()


<ViewProjectForm>
    orientation: "vertical"
    BoxLayout:
        orientation: "vertical"
        size_hint_y: 0.9
        Label:
            id: lbl
            text: "View project!"
        ListView:
            id: projectslist
            item_strings: []
    BoxLayout:
        orientation: "horizontal"
        size_hint_y: 0.1
        Button:
            id: btnGoBack
            text: "Go back"
            size_hint_x: 0.2
            on_press: root.go_back()
        Button:
            id: btnStartObs
            text: "New observation"
            size_hint_x: 0.8
            on_press: root.new_observation()


<SelectProjectForm>
    orientation: "vertical"
    Label:
        height: "40dp"
        size_hint_y: None
        text: "Select a BORIS project file and then press \"Open project\" button"
    FileChooserListView:
        id: projectfilechooser
        path: "."
        filters: ["*.boris"]
    BoxLayout:
        height: "40dp"
        size_hint_y: None
        Button:
            text: "Cancel"
            size_hint_x: 0.2
            on_press: root.cancel()
        Button:
            text: "Open project"
            size_hint_x: 0.8
            on_press: root.open_project(projectfilechooser.path, projectfilechooser.selection)

<StartObservationForm>
    orientation: "vertical"
    obsid_input: obsid
    obsdate_input: obsdate
    obsdescription_input: obsdescription

    BoxLayout:
        orientation: "vertical"
        size_hint_y: 0.9
        BoxLayout:
            size_hint_y: 0.2
            #height: "40dp"
            #size_hint_y: None
            Label:
                size_hint_x: 0.2
                text: "Observation id"
                font_size: 20
            TextInput:
                size_hint_x: 0.8
                multiline: False
                font_size: 25
                id: obsid

        BoxLayout:
            #height: "40dp"
            size_hint_y: 0.2
            #size_hint_y: None
            Label:
                size_hint_x: 0.2
                text: "Observation date"
                font_size: 20
            TextInput:
                size_hint_x: 0.8
                id: obsdate
                multiline: False
                font_size: 25

        BoxLayout:
            #height: "120dp"
            size_hint_y: 0.6
            #size_hint_y: None
            Label:
                size_hint_x: 0.2
                text: "Description"
                font_size: 20
            TextInput:
                size_hint_x: 0.8
                id: obsdescription
                multiline: True
                font_size: 20
    BoxLayout:
        #height: "40dp"
        size_hint_y: 0.1
        #size_hint_y: None
        Button:
            text: "Cancel"
            size_hint_x: 0.2
            on_press: root.cancel()
        Button:
            text: "Independent var"
            size_hint_x: 0.4
            on_press: root.indep_var()
        Button:
            text: "Start observation"
            size_hint_x: 0.4
            on_press: root.start()

<ConfirmStopPopup>
    title: "Are you sure you want to stop the current observation?"
    title_size: "20sp"
    BoxLayout:
        height: "40dp"
        size_hint_y: None
        Button:
            text: "Yes"
            size_hint_x: 0.5
            on_press: root.yes()
        Button:
            text: "No"
            size_hint_x: 0.5
            on_press: root.no()

<AskForExistingFile>
    title: "This project already exists on this device."
    title_size: "20sp"
    BoxLayout:
        #height: "40dp"
        size_hint_y: None
        Button:
            text: "Cancel"
            size_hint_x: 1
            on_press: root.cancel()
        Button:
            text: "Overwrite"
            size_hint_x: 1
            on_press: root.overwrite()
        Button:
            text: "Rename it"
            size_hint_x: 1
            on_press: root.rename()
